<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" href="https://bootswatch.com/4/united/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
      <div class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary">
        <div class="container">
            <a href="../" class="navbar-brand"><img src="assets/img/kotlin.svg" style="height: 30px; display: inline-block;"> Kotlin code anomaly detection</a>
            <div class="collapse navbar-collapse" id="navbarResponsive">
              <ul class="nav navbar-nav ml-auto">
                <a class="nav-item">
                  <a class="nav-link" target="_blank" href="https://github.com/PetukhovVictor/code-anomaly-detection">Repository</a>
                </a>
              </ul>
            </div>
          </div>
      </div>
      <div class="container" style="margin-top: 100px;">
          <h3>Known Kotlin code class anomalies</h3>
          <div class="row" style="margin-top: 30px;">
              <div class="col-lg-4">
                  <ul class="list-group" id="anomaly-classes">
                      <a href="#" id="big_code_hierarchy" class="list-group-item list-group-item-action">
                        Big code hierarchy
                        <span class="badge badge-primary badge-pill float-right">33</span>
                      </a>
                      <a href="#" id="big_multiline_strings" class="list-group-item list-group-item-action">
                        Big multiline strings
                        <span class="badge badge-primary badge-pill float-right">27</span>
                      </a>
                      <a href="#" id="big_static_arrays_or_map" class="list-group-item list-group-item-action">
                        Big static arrays or map
                        <span class="badge badge-primary badge-pill float-right">30</span>
                      </a>
                      <a href="#" id="complex_or_long_logical_expressions" class="list-group-item list-group-item-action">
                        Complex or long logical expressions
                        <span class="badge badge-primary badge-pill float-right">6</span>
                      </a>
                      <a href="#" id="long_calls_chain" class="list-group-item list-group-item-action">
                        Long calls chain
                        <span class="badge badge-primary badge-pill float-right">5</span>
                      </a>
                      <a href="#" id="long_enumerations" class="list-group-item list-group-item-action">
                        Long enumerations
                        <span class="badge badge-primary badge-pill float-right">2</span>
                      </a>
                      <a href="#" id="many_assignment_statements" class="list-group-item list-group-item-action">
                        Many assignment statements
                        <span class="badge badge-primary badge-pill float-right">57</span>
                      </a>
                      <a href="#" id="many_case_in_when" class="list-group-item list-group-item-action">
                        Many case in when
                        <span class="badge badge-primary badge-pill float-right">33</span>
                      </a>
                      <a href="#" id="many_concatenations" class="list-group-item list-group-item-action">
                        Many concatenations
                        <span class="badge badge-primary badge-pill float-right">13</span>
                      </a>
                      <a href="#" id="many_function_arguments" class="list-group-item list-group-item-action">
                        Many function arguments
                        <span class="badge badge-primary badge-pill float-right">17</span>
                      </a>
                      <a href="#" id="many_generic_parameters" class="list-group-item list-group-item-action">
                        Many generic parameters
                        <span class="badge badge-primary badge-pill float-right">6</span>
                      </a>
                      <a href="#" id="many_if_statements" class="list-group-item list-group-item-action">
                        Many if statements
                        <span class="badge badge-primary badge-pill float-right">38</span>
                      </a>
                      <a href="#" id="many_loops" class="list-group-item list-group-item-action">
                        Many loops
                        <span class="badge badge-primary badge-pill float-right">7</span>
                      </a>
                      <a href="#" id="many_similar_call_expressions" class="list-group-item list-group-item-action">
                        Many similar call expressions
                        <span class="badge badge-primary badge-pill float-right">86</span>
                      </a>
                      <a href="#" id="many_var_or_fun_definitions" class="list-group-item list-group-item-action">
                        Many var or fun definitions
                        <span class="badge badge-primary badge-pill float-right">14</span>
                      </a>
                      <a href="#" id="nested_calls" class="list-group-item list-group-item-action">
                        Nested calls
                        <span class="badge badge-primary badge-pill float-right">3</span>
                      </a>
                      <a href="#" id="big_and_complex_enums" class="list-group-item list-group-item-action">
                        Big and complex enums
                        <span class="badge badge-primary badge-pill float-right">3</span>
                      </a>
                      <a href="#" id="big_companion_object" class="list-group-item list-group-item-action">
                        Big companion object
                        <span class="badge badge-primary badge-pill float-right">2</span>
                      </a>
                    </ul>
                </div>
              <div class="col-lg-8 anomalies-block" style="display: none;">
                  <ul class="nav nav-tabs">
                      <li class="nav-item">
                        <a class="nav-link active source-examples" id="cst-examples" data-toggle="tab" href="#cst-anomalies">By CST examples <span class="badge badge-primary badge-pill float-right total" style="margin-left: 10px; margin-top: 3px;"></span></a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link source-examples" id="bytecode-examples" data-toggle="tab" href="#bytecode-anomalies">By JVM-bytecode examples <span class="badge badge-primary badge-pill float-right total" style="margin-left: 10px; margin-top: 3px;"></span></a>
                      </li>
                    </ul>
                    <div class="tab-content">
                      <div class="tab-pane fade show active anomalies-list" id="cst-anomalies">
                          <div style="margin-top: 15px;">
                              <a href="#" id="all_examples_url" target="_blank" style="margin-top: 5px; display: inline-block; float: right;" class="badge badge-primary all_url">All examples</a>
                              <p><b>Most important examples</b></p>
                          </div>
                        <p style="margin-top: 20px;" id="anomaly_examples"></p>
                      </div>
                      <div class="tab-pane fade anomalies-list" id="bytecode-anomalies">
                        <div style="margin-top: 15px;">
                              <a href="#" id="all_examples_url_bytecode" target="_blank" style="margin-top: 5px; display: inline-block; float: right;" class="badge badge-primary all_url">All examples</a>
                              <p><b>Most important examples</b></p>
                          </div>
                        <p style="margin-top: 20px;" id="anomaly_examples_bytecode"></p>
                      </div>
                    </div>
              </div>
            </div>
      </div>
    <script src="https://bootswatch.com/_vendor/bootstrap/dist/js/bootstrap.min.js"></script>
      <script>
        $(document.body).on("click", ".spoiler-trigger", function() {
            $(this).parent().next().collapse('toggle');
        });
        var examplesMap = {
          "big_code_hierarchy": {
            "cstExamples": {
              "total": 30,
              "all_url": "https://yadi.sk/d/IrbdGxNE3Sp9Uv",
              "items": {
                "1741_0924744.kt": "151957f7945e3263b57250e77dfdb144",
                "1074_71399994.kt": "539c0d2f726ab9d172c2ba832647bb59",
                "1069_46563454.kt": "51faa4f6fe65ce5ffe7dcf07277298fc",
                "898_05903588.kt": "b3699e54be5e89620ef21d7daff046d5"
              }
            },
            "bytecodeExamples": {
              "total": 3,
              "all_url": "https://yadi.sk/d/YCnuCJct3T458t",
              "items": [
                    {
                        "1239_EditorStage.kt": "32c2862d60e8a6dbdffde10c894eb0ee",
                        "1239_EditorStage.class.json": "23bf17aa90861ccf53bfaf64540c9f3e"
                    },
                    {
                        "1012_widgets.kt": "3bfc65560dbe242770a197e4f70d6010",
                        "1012_widgets.class.json": "2acac35b52e41e10cd5f8ee7d9720ecb"
                    },
                    {
                        "367_TextEditState.kt": "1367d67f947a371b4cab7df9699e2ebe",
                        "367_TextEditState.class.json": "f07d6a0bb71036edf3a9fcc0c478d194"
                    }
                ]
            }
          },
          "big_multiline_strings": {
            "cstExamples": {
              "total": 27,
              "all_url": "https://yadi.sk/d/9Au__OYE3SpBCr",
              "items": {
                "2186_41650207.kt": "002658e398499aba5af48079b757ee37",
                "1334_20790702.kt": "8f99a88a788a7df5527d353249b757b7",
                "1059_98046631.kt": "c1bce32a004307edc75c2b1b06e8741e"
              }
            }
          },
          "big_static_arrays_or_map": {
            "cstExamples": {
              "total": 30,
              "all_url": "https://yadi.sk/d/maeusvha3SpBNz",
              "items": {
                "9619_60767009.kt": "0d8e93f7a4d5d2d90cd21dfe3db08ba9",
                "2674_55547561.kt": "42e6133f25da84e2441f860a31a9b6fa",
                "980_875609694.kt": "284565b7378498a33b08d616e89c1d5c",
                "851_999352119.kt": "e7ca55cc400dc58bd2c69b16301047c4",
                "845_169014207.kt": "716c3b8666504a113a378672f90ca805",
                "695_518795113.kt": "e696d3e199af4097ae248b11a9796325"
              }
            }
          },
          "complex_or_long_logical_expressions": {
            "cstExamples": {
              "total": 6,
              "all_url": "https://yadi.sk/d/5G06go5u3SpBb4",
              "items": {
                "1059_98046631.kt": "3647ffb32f84ccc3d2a70f8c307ba73b",
                "915_130522116.kt": "dc6328ef8f09d1cf92579fc9eb232c6a",
                "820_667231648.kt": "b300171c7ed957ed63dab31478ddae91"
              }
            }
          },
          "long_calls_chain": {
            "cstExamples": {
              "total": 5,
              "all_url": "https://yadi.sk/d/W8eMX2-O3SpBVD",
              "items": {
                "2248_26554994.kt": "2b99468058b33bf3b2b7cc5a58e066c6",
                "727_697819708.kt": "b7e12a90af763f8391c2ae8106079b6d",
                "518_805403162.kt": "2246bf7576e58da5b21daab33b8ef2c5",
                "461_072377513.kt": "5f7dea7728ddbd95f2f776de019dc5d5"
              }
            }
          },
          "long_enumerations": {
            "cstExamples": {
              "total": 2,
              "all_url": "https://yadi.sk/d/bDlWpiO43SpBsG",
              "items": {
                "1403_48722141.kt": "78471c599da5c5f3833d750c1e89121c",
                "1391_26303605.kt": "8bb6cfe1e759e798812684a14ecfb2a7"
              }
            }
          },
          "many_assignment_statements": {
            "cstExamples": {
              "total": 57,
              "all_url": "https://yadi.sk/d/jf5FdjE83SpAjD",
              "items": {
                "4177_1494766.kt": "e1b0a656056130c04adb1b68c8598819",
                "1262_83299418.kt": "f5cfd5c6f15a43127653aaffa1a4de57",
                "957_169484679.kt": "00a45839580e6324bebaa827f096b1b4"
              }
            }
          },
          "many_case_in_when": {
            "cstExamples": {
              "total": 33,
              "all_url": "https://yadi.sk/d/OFBOzJAD3Sp97x",
              "items": {
                "9427_45911639.kt": "e181a0760133fc553f53009f73c54980",
                "2731_22781338.kt": "be00cb93e1a670b50778c4c88cb6446b",
                "2359_47083853.kt": "3b1971a3c1dcb80d724a728f0d562909",
                "2238_22719281.kt": "365a663c52112c79f3f9a754c201f2f5"
              }
            }
          },
          "many_concatenations": {
            "cstExamples": {
              "total": 13,
              "all_url": "https://yadi.sk/d/x2tiYbks3SpC6X",
              "items": {
                "995_169554923.kt": "9d9383d79ca8c37974eab98b873c176f",
                "908_098222933.kt": "501219b23efa03cb32337a018331867e",
                "679_718858732.kt": "08b2482ad8399fd6f84a19aa1ae028d1",
                "666_093862254.kt": "8e26e362c638bd11db7a69b9bb152f23"
              }
            }
          },
          "many_function_arguments": {
            "cstExamples": {
              "total": 17,
              "all_url": "https://yadi.sk/d/AkRgNLdo3SpCCo",
              "items": {
                "9619_60767009.kt": "e41da15240b19c83394d366c1b068f32",
                "934_279728986.kt": "1c5d2b61a1b9e79dd9b0ec5a0e845d8e",
                "787_781482349.kt": "5eba165d3cbbb9bbb58905bd14ace270"
              }
            }
          },
          "many_generic_parameters": {
            "cstExamples": {
              "total": 6,
              "all_url": "https://yadi.sk/d/8LaLMlqX3Sp8it",
              "items": {
                "600_498460165.kt": "6e693a9024fec693edb277312f59f144"
              }
            }
          },
          "many_if_statements": {
            "cstExamples": {
              "total": 38,
              "all_url": "https://yadi.sk/d/xqzFZE_33Sp9Dt",
              "items": {
                "2413_79989814.kt": "b363cb1d53b039779d9a9d8a6aec6118",
                "1741_0924744.kt": "fd0dd19a1a988c1a6153d55a47a76f03",
                "1119_62992668.kt": "a8c5fa7bb73464de48cc61113956e4ca"
              }
            }
          },
          "many_loops": {
            "cstExamples": {
              "total": 7,
              "all_url": "https://yadi.sk/d/EWJ6bcsN3SpCGq",
              "items": {
                "2041_57944715.kt": "7612e9b81b277b7b9f6f04e652bc7157",
                "1808_79882816.kt": "10a19069d6b179a7b8cbb3077f65040e",
                "1069_46563454.kt": "861ed527a8ea0b7225825b12367ceb80"
              }
            }
          },
          "many_similar_call_expressions": {
            "cstExamples": {
              "total": 86,
              "all_url": "https://yadi.sk/d/oy7fdVDS3Sp9s3",
              "items": {
                "14288_0148376.kt": "87d591a6702bf46f0ce87ff91904d0a6",
                "13421_6491434.kt": "75c510080b5599edcc693389b67ab19a",
                "6512_57228688.kt": "95839918e64210895c371129442dd754",
                "2703_26722649.kt": "273a8aaa549c118732a23d9fcdf8404c"
              }
            }
          },
          "many_var_or_fun_definitions": {
            "cstExamples": {
              "total": 14,
              "all_url": "https://yadi.sk/d/iTTQJOFd3SpADb",
              "items": {
                "4891_63999481.kt": "4f04b991eb5a2d3a783df5932ff2b5e2",
                "2740_93778153.kt": "915fb4b3b9a91e8402e5b887a69be5d4",
                "2547_91645477.kt": "af66f92f3c43cb58a6ec280e13b73e63"
              }
            }
          },
          "nested_calls": {
            "cstExamples": {
              "total": 3,
              "all_url": "https://yadi.sk/d/clEG8QbV3SpB6N",
              "items": {
                "2179_95451312.kt": "5a3e032ed5e6e2e4db89d4b37f8af101",
                "1789_55786539.kt": "23d95b306437a158494472730a747d69",
                "506_004230873.kt": "d388c2a77744d897cf74c07ed345d915"
              }
            }
          },
          "big_and_complex_enums": {
            "bytecodeExamples": {
              "total": 3,
              "all_url": "https://yadi.sk/d/yyWj_N5N3T3wwd",
              "items": [
                    {
                        "4168_Book.kt": "d24329380b308b672f37edfbb33386d6",
                        "4168_Book.class.json": "d3d567937029579a254735e14e9668f3"
                    },
                    {
                        "1985_LatexNoMathCommand.kt": "5e3b21d8a2d1f932ca3ad99c24d7fdd3",
                        "1985_LatexNoMathCommand.class.json": "7162bc04e58ae9840a25969afd11d47d"
                    }
                ]
            }
          },
          "big_companion_object": {
            "bytecodeExamples": {
              "total": 2,
              "all_url": "https://yadi.sk/d/keDdiPKj3T45uh",
              "items": [
                    {
                        "1814_CSS.kt": "03b7c57c8614e646886dbb6c0b71c5e4",
                        "1814_PropertyHolder.class.json": "4c285397769a1bef4e233e11a361edf0"
                    },
                    {
                        "366_JSONConverter.kt": "9fa7524220876a4a901646f8587a5936",
                        "366_JSONConverter$Companion.class.json": "7422a361c337190530a79564c5340d76"
                    }
                ]
            }
          }
        }
        var content = '';
        document.write = function(s) {
            content += s;
        };

        function loadExamples(classInfo, source, sourceText) {
            if (classInfo.cstExamples) {
                $("#cst-examples").show()
                $("#cst-examples .total").text(classInfo.cstExamples.total);
            } else {
                $("#cst-examples").hide();
            }
            if (sourceText == "cst") {
                $(".source-examples").removeClass("active");
                $("#cst-examples").addClass("active");
                $(".anomalies-list").hide();
                $("#cst-anomalies").show().css("opacity", 1.0);
            }
            if (classInfo.bytecodeExamples) {
                $("#bytecode-examples").show()
                $("#bytecode-examples .total").text(classInfo.bytecodeExamples.total);
            } else {
                $("#bytecode-examples").hide();
            }
            if (sourceText == "bytecode") {
                $(".source-examples").removeClass("active");
                $("#bytecode-examples").addClass("active");
                $(".anomalies-list").hide();
                $("#bytecode-anomalies").show().css("opacity", 1.0);
            }
            var requested = 0;

            if (sourceText == "cst") {
                var contents = [];
                $("#anomaly_examples").html('Loading examples...');
                $("#all_examples_url").attr("href", source.all_url);
                var i = 1;
                for (var key in source.items) {
                    var item = source.items[key];
                    requested++;
                    $.getScript('https://gist.github.com/PetukhovVictor/' + item + '.js', function(i, key, item) {
                         return function() {
                            requested--;
                            contents[i - 1] = '<div class="panel panel-default" style="margin-bottom: 24px;"><div class="panel-heading"><button type="button" style="background: #eee;border-bottom-left-radius: 0;border-bottom-right-radius: 0;display: block;width: 100%;text-align: left;" class="btn btn-default btn-xs spoiler-trigger" data-toggle="collapse">Example ' + i + ': <b>' + key + '</b></button></div><div class="panel-collapse collapse out"><div class="panel-body">' + content + '</div></div></div>';

                            if (requested == 0) {
                                $("#anomaly_examples").empty();
                                contents.forEach(function(content) {
                                    $("#anomaly_examples").append(content);
                                })
                            }
                            content = '';
                         }
                    }(i, key, item));
                    i++;
                }
            } else if (sourceText == "bytecode") {
                var contents = [];
                $("#anomaly_examples_bytecode").html('Loading examples...');
                $("#all_examples_url_bytecode").attr("href", source.all_url);
                var i = 1;
                console.log(source.items);
                for (var key in source.items) {
                    var item = source.items[key];
                    contents[i - 1] = [];
                    var j = 0;
                    for (var partKey in item) {
                        partItem = item[partKey];
                        requested++;
                        $.getScript('https://gist.github.com/PetukhovVictor/' + partItem + '.js', function(i, j, key, item) {
                             return function() {
                                requested--;
                                contents[i - 1][j] = '<div class="panel panel-default" style="margin-bottom: 24px;"><div class="panel-heading"><button type="button" style="background: #eee;border-bottom-left-radius: 0;border-bottom-right-radius: 0;display: block;width: 100%;text-align: left;" class="btn btn-default btn-xs spoiler-trigger" data-toggle="collapse">Example ' + i + ': <b>' + key + '</b></button></div><div class="panel-collapse collapse out"><div class="panel-body">' + content + '</div></div></div>';

                                if (requested == 0) {
                                    $("#anomaly_examples_bytecode").empty();
                                    contents.forEach(function(contentPart) {
                                        contentPart.forEach(function(content) {
                                            $("#anomaly_examples_bytecode").append(content);
                                        })
                                        $("#anomaly_examples_bytecode").append("<hr />");
                                    })
                                }
                                content = '';
                             }
                        }(i, j, partKey, partItem));
                        j++;
                    }
                    i++;
                }
            }
        }

        $("#anomaly-classes .list-group-item").on("click", function() {
            $("#anomaly-classes .list-group-item").removeClass("active");
            $(this).addClass("active");
            $(".anomalies-block").show();
            var classId = $(this).attr("id");
            var classInfo = examplesMap[classId];
            window.currentClassInfo = classInfo;

            var source;
            var sourceText;

            if (classInfo.cstExamples) {
                source = classInfo.cstExamples;
                sourceText = "cst";
            } else if (classInfo.bytecodeExamples) {
                source = classInfo.bytecodeExamples;
                sourceText = "bytecode";
            }

            loadExamples(classInfo, source, sourceText);
        })

        $(".source-examples").on("click", function() {
            var source;
            var sourceText;
            var id = $(this).attr("id");

            if (id == "cst-examples") {
                source = window.currentClassInfo.cstExamples;
                sourceText = "cst";
            } else if (id == "bytecode-examples") {
                source = window.currentClassInfo.bytecodeExamples;
                sourceText = "bytecode";
            }

            loadExamples(window.currentClassInfo, source, sourceText);
        })
      </script>
  </body>
</html>