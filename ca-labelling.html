<!-- Custom code anomaly labelling interface for Labelbox -->
<script src="https://api.labelbox.io/client/v0.1/labeling-api.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.3.3/ace.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.7.1/gist-embed.min.js"></script>

<div id="gistZone"></div>

<div style="display: flex;">
  <button onclick="label('want_more')">Want more</button>
  <button onclick="label('enough')">Enough</button>
  <button onclick="label('useless')">Useless</button>
</div>

<script>

function label(label) {
  Labelbox.setLabelForAsset(label).then(() => {
    Labelbox.fetchNextAssetToLabel();
  });
}

Labelbox.currentAsset().subscribe((asset) => {
  if (asset) {
    // Create an iframe, append it to this document where specified
    var gistFrame = document.createElement("iframe");
    gistFrame.setAttribute("width", "100%");
    gistFrame.setAttribute("height", "70%");
    gistFrame.id = "gistFrame";

    var zone = document.getElementById("gistZone");
    zone.innerHTML = "";
    zone.appendChild(gistFrame);

    // Create the iframe's document
    var gistFrameHTML = '<html><body><scr' +
        'ipt type="text/javascript" src="' + asset.data + '.js"></sc' + 'ript></body></html>';

    // Set iframe's document with a trigger for this document to adjust the height
    var gistFrameDoc = gistFrame.document;

    if (gistFrame.contentDocument) {
      gistFrameDoc = gistFrame.contentDocument;
    } else if (gistFrame.contentWindow) {
      gistFrameDoc = gistFrame.contentWindow.document;
    }

    gistFrameDoc.open();
    gistFrameDoc.writeln(gistFrameHTML);
    gistFrameDoc.close();

    // var gistId = asset.data.split(/[/ ]+/).pop();
    // debug.innerHTML = gistId;
    // contentArea.innerHTML = '<code data-gist-id="' + gistId + '"></code>';
    // contentArea.gist();
    // debug.innerHTML = gistId + '<br><pre>' + contentArea.innerHTML + '</pre>';
  }
})

</script>
